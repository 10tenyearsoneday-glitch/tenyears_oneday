<!doctype html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>åå¹´ä¸€æ—¥ TEN YEARS ONE DAY</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@300;400;600&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg1:#eef4ee; --bg2:#e6efe6;
      --green-900:#1f2b22; --green-700:#2f3c33;
      --sage:#6f7f73; --line:#d7e1d8;
      --card:rgba(255,255,255,.86); --card2:rgba(255,255,255,.72);
      --shadow:0 18px 48px rgba(10,18,12,.10);
      --radius:18px; --radius2:24px;
      --serif:"Noto Serif TC", serif;
      --sans:"Inter", system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial;
      --max:1120px;
    }
    *{ box-sizing:border-box; }
    html{ scroll-behavior:smooth; }
    body{
      margin:0;
      color:var(--green-700);
      font-family:var(--serif);
      background:
        radial-gradient(1200px 380px at 55% 180px, rgba(76,94,83,.10), transparent 60%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
    }
    .wrap{ max-width:var(--max); margin:0 auto; padding:28px 18px 40px; }
    header{ display:flex; align-items:flex-start; justify-content:space-between; gap:16px; }
    .brand{ display:flex; flex-direction:column; gap:6px; min-width:220px; }
    .brand .name{ font-size:34px; letter-spacing:.10em; color:var(--green-900); font-weight:400; }
    .brand .handle{ color:var(--sage); font-style:italic; letter-spacing:.04em; font-size:14px; opacity:.95; }
    .icons{ display:flex; align-items:center; gap:10px; padding-top:10px; }
    .icon-btn{
      width:38px; height:38px; border-radius:999px;
      background:rgba(255,255,255,.55);
      border:1px solid rgba(215,225,216,.9);
      display:grid; place-items:center;
      box-shadow:0 8px 24px rgba(10,18,12,.06);
      cursor:pointer;
      transition:transform .12s ease, background .12s ease;
      text-decoration:none;
    }
    .icon-btn:hover{ transform:translateY(-1px); background:rgba(255,255,255,.8); }
    .icon{ width:18px; height:18px; color:var(--green-700); opacity:.92; }

    nav{ margin-top:16px; display:flex; flex-wrap:wrap; gap:10px; align-items:center; }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:9px 14px; border-radius:999px;
      border:1px solid rgba(215,225,216,.95);
      background:rgba(255,255,255,.48);
      color:var(--green-700);
      text-decoration:none;
      font-size:14px;
      letter-spacing:.02em;
      transition:background .12s ease, transform .12s ease;
      user-select:none;
    }
    .pill:hover{ background:rgba(255,255,255,.78); transform:translateY(-1px); }
    .pill.active{ background:rgba(31,43,34,.10); border-color:rgba(31,43,34,.18); color:var(--green-900); }

    .hero{
      margin-top:16px;
      border-radius:var(--radius2);
      background:
        linear-gradient(90deg, rgba(31,43,34,.06), rgba(31,43,34,.03)),
        linear-gradient(180deg, rgba(76,94,83,.12), rgba(76,94,83,.06));
      border:1px solid rgba(215,225,216,.85);
      padding:30px 18px 34px;
      position:relative;
      overflow:hidden;
    }
    .hero:before{
      content:"";
      position:absolute; inset:-40px -60px auto auto;
      width:220px; height:220px;
      background:radial-gradient(circle at 35% 35%, rgba(255,255,255,.65), rgba(255,255,255,0) 60%);
      transform:rotate(12deg);
      pointer-events:none;
    }
    .hero-inner{ display:grid; justify-items:center; gap:18px; text-align:center; padding:10px 0 0; }
    .hero-title{ font-size:30px; font-weight:400; letter-spacing:.14em; color:var(--green-900); margin:0; }
    .hero-sub{ margin:0; font-size:14px; line-height:1.9; color:var(--sage); letter-spacing:.06em; white-space:pre-line; }

    .card{
      width:min(780px, 96%);
      margin-top:16px;
      border-radius:22px;
      background:var(--card);
      border:1px solid rgba(215,225,216,.95);
      box-shadow:var(--shadow);
      padding:22px 18px;
      backdrop-filter: blur(8px);
    }
    .card h2{ margin:0 0 8px; font-size:22px; letter-spacing:.08em; font-weight:400; color:var(--green-900); }
    .card .en{ margin:0 0 2px; font-style:italic; letter-spacing:.05em; color:var(--sage); font-size:14px; }
    .card .tagline{ margin:0 0 12px; font-style:italic; color:var(--sage); letter-spacing:.04em; opacity:.95; font-size:13px; }
    .dash{ width:160px; margin:14px auto; border:none; border-top:1px dashed rgba(111,127,115,.55); }
    .card .body{ margin:0; white-space:pre-line; line-height:2.0; color:var(--green-700); letter-spacing:.02em; font-size:14px; }

    .announcement{
      margin:18px auto 0;
      width:min(860px, 96%);
      display:flex; gap:10px; align-items:flex-start;
      padding:14px 16px;
      border-radius:14px;
      border:1px solid rgba(215,225,216,.95);
      background:rgba(255,255,255,.52);
    }
    .badge{
      flex:0 0 auto;
      padding:6px 10px;
      border-radius:999px;
      background:rgba(31,43,34,.10);
      color:var(--green-900);
      font-size:12px;
      letter-spacing:.06em;
    }
    .announcement p{ margin:2px 0 0; line-height:1.8; font-size:13px; color:var(--sage); letter-spacing:.03em; white-space:pre-line; }

    section{ margin-top:28px; padding-top:14px; }
    .section-head{ display:flex; align-items:baseline; justify-content:space-between; gap:12px; margin:0 0 10px; }
    .section-head h3{ margin:0; font-size:18px; letter-spacing:.10em; color:var(--green-900); font-weight:400; }
    .section-head .hint{ font-size:12px; color:rgba(111,127,115,.9); letter-spacing:.04em; font-style:italic; }

    .grid{ display:grid; grid-template-columns:repeat(12, 1fr); gap:14px; }
    .panel{
      grid-column: span 6;
      background:var(--card2);
      border:1px solid rgba(215,225,216,.95);
      border-radius:18px;
      box-shadow:0 10px 28px rgba(10,18,12,.07);
      padding:16px;
    }
    .panel p{ margin:0; font-size:14px; line-height:1.9; color:var(--green-700); white-space:pre-line; }

    .shipbar{
      grid-column: 1 / -1;
      display:flex; justify-content:space-between; align-items:center; gap:10px;
      padding:12px 14px;
      border-radius:14px;
      background:rgba(31,43,34,.06);
      border:1px solid rgba(215,225,216,.95);
      color:var(--green-700);
      font-size:13px;
      letter-spacing:.03em;
    }
    .shipbar .edit{ font-size:12px; color:rgba(111,127,115,.9); font-style:italic; }

    .products{
      grid-column: 1 / -1;
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:14px;
    }
    .product{
      background:rgba(255,255,255,.72);
      border:1px solid rgba(215,225,216,.95);
      border-radius:18px;
      padding:14px 14px 12px;
      box-shadow:0 10px 28px rgba(10,18,12,.07);
      display:flex;
      flex-direction:column;
      gap:10px;
      min-height:180px;
    }
    .product .top{ display:flex; align-items:flex-start; justify-content:space-between; gap:10px; }
    .product h4{ margin:0; font-size:16px; letter-spacing:.06em; color:var(--green-900); font-weight:400; line-height:1.35; }
    .product .price{ font-family:var(--sans); font-size:13px; color:var(--green-700); padding-top:2px; letter-spacing:.02em; white-space:nowrap; }
    .product .meta{ display:flex; gap:8px; flex-wrap:wrap; }
    .chip{ font-size:12px; padding:6px 10px; border-radius:999px; background:rgba(31,43,34,.08); color:var(--green-700); border:1px solid rgba(215,225,216,.95); letter-spacing:.04em; }
    .product .desc{ margin:0; font-size:13px; color:var(--sage); line-height:1.8; }
    .product .actions{ margin-top:auto; display:flex; gap:10px; align-items:center; }
    .btn{
      appearance:none;
      border:1px solid rgba(31,43,34,.18);
      background:rgba(31,43,34,.06);
      color:var(--green-900);
      font-family:var(--serif);
      border-radius:999px;
      padding:9px 12px;
      font-size:13px;
      letter-spacing:.04em;
      cursor:pointer;
      transition:transform .12s ease, background .12s ease;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:8px;
    }
    .btn:hover{ transform:translateY(-1px); background:rgba(31,43,34,.10); }
    .btn.ghost{ background:rgba(255,255,255,.55); border-color:rgba(215,225,216,.95); color:var(--green-700); }

    footer{
      margin-top:28px;
      border-top:1px solid rgba(215,225,216,.9);
      padding:18px 0 0;
      color:rgba(111,127,115,.95);
      font-size:13px;
      letter-spacing:.02em;
      text-align:center;
    }

    .modal-backdrop{
      position:fixed; inset:0;
      background:rgba(0,0,0,.28);
      display:none;
      align-items:center; justify-content:center;
      padding:16px;
      z-index:50;
    }
    .modal{
      width:min(560px, 96vw);
      background:rgba(255,255,255,.92);
      border:1px solid rgba(215,225,216,.95);
      border-radius:18px;
      box-shadow:0 24px 60px rgba(0,0,0,.25);
      padding:16px 16px 14px;
      backdrop-filter: blur(10px);
    }
    .modal .row{ display:flex; justify-content:space-between; align-items:center; gap:12px; }
    .modal h5{ margin:0; font-size:16px; letter-spacing:.06em; color:var(--green-900); font-weight:400; }
    .modal .close{ border:none; background:transparent; font-size:18px; cursor:pointer; color:rgba(31,43,34,.65); }
    .modal .items{ margin-top:10px; border-top:1px dashed rgba(111,127,115,.45); padding-top:10px; display:flex; flex-direction:column; gap:10px; }
    .item{ display:flex; justify-content:space-between; gap:12px; align-items:flex-start; padding:10px; border-radius:14px; background:rgba(31,43,34,.04); border:1px solid rgba(215,225,216,.85); }
    .item .name{ font-size:13px; color:var(--green-900); letter-spacing:.03em; line-height:1.6; }
    .item .sub{ font-size:12px; color:rgba(111,127,115,.95); letter-spacing:.02em; margin-top:2px; }
    .item .right{ text-align:right; white-space:nowrap; font-family:var(--sans); font-size:12px; color:var(--green-700); }

    @media (max-width: 920px){ .panel{ grid-column: 1 / -1; } }
    @media (max-width: 860px){ .products{ grid-template-columns: 1fr; } .brand .name{ font-size:30px; } }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="name" id="brandNameZh">åå¹´ä¸€æ—¥</div>
        <div class="handle" id="brandHandle">tenyears_oneday</div>
      </div>

      <div class="icons" aria-label="header icons">
        <button class="icon-btn" id="btnSearch" title="æœå°‹" aria-label="æœå°‹">
          <svg class="icon" viewBox="0 0 24 24" fill="none">
            <path d="M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z" stroke="currentColor" stroke-width="1.6"/>
            <path d="M16.4 16.4 21 21" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
          </svg>
        </button>
        <a class="icon-btn" id="btnIG" href="#" target="_blank" rel="noopener" title="Instagram" aria-label="Instagram">
          <svg class="icon" viewBox="0 0 24 24" fill="none">
            <rect x="6.2" y="6.2" width="11.6" height="11.6" rx="3" stroke="currentColor" stroke-width="1.6"/>
            <path d="M12 15.1a3.1 3.1 0 1 0 0-6.2 3.1 3.1 0 0 0 0 6.2Z" stroke="currentColor" stroke-width="1.6"/>
            <path d="M16.7 7.6h.01" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
          </svg>
        </a>
        <a class="icon-btn" id="btnLINE" href="#" target="_blank" rel="noopener" title="LINE" aria-label="LINE">
          <svg class="icon" viewBox="0 0 24 24" fill="none">
            <path d="M6.2 8.7c0-2.4 2.6-4.4 5.8-4.4s5.8 2 5.8 4.4-2.6 4.4-5.8 4.4c-.4 0-.8 0-1.2-.1l-2.9 1 .9-2.3c-1.6-.8-2.6-1.9-2.6-3Z" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/>
            <path d="M9.1 8.8h.01M11.6 8.8h.01M14.1 8.8h.01" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
          </svg>
        </a>
        <button class="icon-btn" id="btnCart" title="è³¼ç‰©è»Š" aria-label="è³¼ç‰©è»Š">
          <svg class="icon" viewBox="0 0 24 24" fill="none">
            <path d="M6.5 7.5h14l-1.2 7H8.2L6.5 7.5Z" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/>
            <path d="M6.5 7.5 5.7 4.8H3.5" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
            <path d="M9 19.2a.8.8 0 1 0 0-1.6.8.8 0 0 0 0 1.6ZM18 19.2a.8.8 0 1 0 0-1.6.8.8 0 0 0 0 1.6Z" fill="currentColor"/>
          </svg>
        </button>
        <button class="icon-btn" id="btnAccount" title="æœƒå“¡" aria-label="æœƒå“¡">
          <svg class="icon" viewBox="0 0 24 24" fill="none">
            <path d="M12 12.2a3.4 3.4 0 1 0 0-6.8 3.4 3.4 0 0 0 0 6.8Z" stroke="currentColor" stroke-width="1.6"/>
            <path d="M5.6 20.2c1.5-3 4-4.2 6.4-4.2s4.9 1.2 6.4 4.2" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
          </svg>
        </button>
      </div>
    </header>

    <nav id="navPills" aria-label="site navigation">
      <a class="pill active" href="#about">é—œæ–¼æˆ‘å€‘</a>
      <a class="pill" href="#collection">å…¨ç³»åˆ— ğŸŒ¸</a>
      <a class="pill" href="#silver">ç´”éŠ€é£¾å“ âœ¨</a>
      <a class="pill" href="#promo">å„ªæƒ æ´»å‹• ğŸ</a>
      <a class="pill" href="#knowledge">é£¾å“å°çŸ¥è­˜ ğŸ’¡</a>
      <a class="pill" href="#faq">ç›¸é—œå•é¡Œ â—</a>
    </nav>

    <div class="hero" id="top">
      <div class="hero-inner">
        <h1 class="hero-title" id="heroTitle">åå¹´ä¸€æ—¥</h1>
        <p class="hero-sub" id="heroSubtitle">æ™‚å…‰æ·¬éŠãƒ»ç ´ç¢ä¸­å°‹è¦“æ°¸æ†
æ¯ä¸€ä»¶é£¾å“ éƒ½æ˜¯æ™‚é–“çš„è©©ç¯‡</p>

        <div class="card" id="welcomeCard">
          <h2 id="welcomeTitle">æ­¡è¿ä¾†åˆ° åå¹´ä¸€æ—¥</h2>
          <p class="en" id="brandNameEn">TEN YEARS ONE DAY</p>
          <p class="tagline" id="welcomeTagline">Every piece tells a story.</p>
          <hr class="dash" />
          <p class="body" id="welcomeBody"></p>
        </div>

        <div class="announcement" id="announcementBox">
          <div class="badge" id="announcementLabel">å…¬å‘Š</div>
          <p id="announcementText"></p>
        </div>
      </div>
    </div>

    <section id="about">
      <div class="section-head">
        <h3>é—œæ–¼æˆ‘å€‘</h3>
        <div class="hint">serif Â· soft Â· calm</div>
      </div>
      <div class="grid">
        <div class="panel">
          <p>ä½ å¯ä»¥æŠŠã€Œå“ç‰Œæ•…äº‹ã€æ”¾åœ¨é€™è£¡ã€‚

æˆ‘å·²ç¶“å¹«ä½ åšæˆ Canva é¢¨æ ¼ï¼šæŸ”å’Œç¶ åº•ã€åŠé€æ˜ç»ç’ƒå¡ç‰‡ã€æ–œé«”è‹±æ–‡ã€è™›ç·šåˆ†éš”ã€‚</p>
        </div>
        <div class="panel">
          <p>è‹¥ä½ æƒ³è¦æ›´åƒ Canvaï¼š
â€¢ æ–‡å­—é–“è·æ›´ç´°ç·»
â€¢ Icon æ›´è¼•
â€¢ å°è¦½æ›´åƒ pill

æˆ‘ä¹Ÿéƒ½å·²ç¶“åšåˆ°é€™ç‰ˆçš„åŸºç¤äº†ã€‚</p>
        </div>
      </div>
    </section>

    <section id="collection">
      <div class="section-head">
        <h3>å…¨ç³»åˆ—</h3>
        <div class="hint">å¯ä»¥æ”¾åˆ†é¡/ç³»åˆ—ä»‹ç´¹</div>
      </div>
      <div class="grid">
        <div class="panel">
          <p>é€™è£¡å¯ä»¥æ”¾ï¼š
- ç†±é–€æ–°å“
- è¿‘æœŸä¸Šæ¶
- ä¸»æ‰“ç³»åˆ—

ä½ ä¹‹å¾Œè¦æŠŠå•†å“åšæˆã€Œå¯ç›´æ¥çµå¸³ã€ä¹Ÿå¯ä»¥ï¼ˆStripe Payment Linksï¼‰ã€‚</p>
        </div>
        <div class="panel">
          <p>å»ºè­°åšæ³•ï¼š
- æ¯å€‹å•†å“ä¸€å¼µå¡
- æŒ‰ã€Œç«‹å³è³¼è²·ã€è·³ Stripe ä»˜æ¬¾
- æˆ–å…ˆåŠ è³¼ç‰©è»Šï¼ˆç°¡æ˜“ï¼‰

æˆ‘å…ˆåšäº†ã€Œç¤ºç¯„å•†å“å€ã€åœ¨ä¸‹æ–¹çš„ã€Œç´”éŠ€é£¾å“ã€ã€‚</p>
        </div>
      </div>
    </section>

    <section id="silver">
      <div class="section-head">
        <h3>ç´”éŠ€é£¾å“</h3>
        <div class="hint">TWD Â· å¯æ”¾å…é‹æ´»å‹•</div>
      </div>
      <div class="grid">
        <div class="shipbar">
          <div id="freeShippingText">å…é‹æ´»å‹•ï¼šæ»¿ NT$1,200 å…é‹ï¼ˆå¯éš¨æ™‚æ›´æ”¹ï¼‰</div>
          <div class="edit">ï¼ˆå¯åœ¨ data/content.json ä¿®æ”¹ï¼‰</div>
        </div>
        <div class="products" id="productsGrid"></div>
      </div>
    </section>

    <section id="promo">
      <div class="section-head">
        <h3>å„ªæƒ æ´»å‹•</h3>
        <div class="hint">å¯ä»¥éš¨æ™‚æ›´æ”¹</div>
      </div>
      <div class="grid">
        <div class="panel" style="grid-column:1/-1">
          <p><b>å°æé†’ï¼š</b>ä½ å‰›å‰›é‡åˆ° Netlifyã€Œç”¨é‡/é¡åº¦ã€æš«åœï¼Œæ˜¯å¹³å°é™åˆ¶ã€‚

é€™ä¸€ç‰ˆå®Œå…¨ä¸é å¾Œå°/ä¸é  Netlify ä¹Ÿèƒ½è·‘ï¼š
âœ… GitHub Pages
âœ… ä»»ä¸€éœæ…‹ç©ºé–“

æ´»å‹•å…§å®¹ä½ å¯ä»¥ç›´æ¥æ”¹ data/content.json çš„ free_shipping_text & announcement_textã€‚</p>
        </div>
      </div>
    </section>

    <section id="knowledge">
      <div class="section-head">
        <h3>é£¾å“å°çŸ¥è­˜</h3>
        <div class="hint">å¯ä»¥æ”¾ä¿é¤Šã€æè³ªã€å°ºå¯¸</div>
      </div>
      <div class="grid">
        <div class="panel">
          <p>â€¢ ç´”éŠ€ä¿é¤Šï¼šé¿å…é•·æ™‚é–“æ¥è§¸æº«æ³‰/åŒ–å­¸å“
â€¢ æ”¶ç´ï¼šä¹¾ç‡¥å¯†å°ã€å¯æ”¾é˜²æ½®åŒ…
â€¢ æ¸…æ½”ï¼šæ‹­éŠ€å¸ƒè¼•æ“¦å³å¯</p>
        </div>
        <div class="panel">
          <p>â€¢ å°ºå¯¸å»ºè­°ï¼šæˆ’åœé‡æ¸¬ã€é …éŠé•·åº¦
â€¢ éæ•ï¼šä½æ•æè³ªèªªæ˜
â€¢ è®Šè‰²ï¼šå±¬æ­£å¸¸æ°§åŒ–ï¼Œå¯æ¸…æ½”æ¢å¾©å…‰æ¾¤</p>
        </div>
      </div>
    </section>

    <section id="faq">
      <div class="section-head">
        <h3>ç›¸é—œå•é¡Œ</h3>
        <div class="hint">FAQ</div>
      </div>
      <div class="grid">
        <div class="panel">
          <p><b>Qï¼š</b>å¯ä»¥é€€æ›å—ï¼Ÿ
<b>Aï¼š</b>å¯åœ¨é€™è£¡æ”¾é€€æ›è²¨è¦å‰‡ã€‚</p>
        </div>
        <div class="panel">
          <p><b>Qï¼š</b>å¤šä¹…å‡ºè²¨ï¼Ÿ
<b>Aï¼š</b>å¯åœ¨é€™è£¡æ”¾å‡ºè²¨å¤©æ•¸ã€ç‰©æµæ–¹å¼ã€‚</p>
        </div>
      </div>
    </section>

    <footer id="footerText">Â© åå¹´ä¸€æ—¥ tenyears_oneday</footer>
  </div>

  <div class="modal-backdrop" id="cartBackdrop" role="dialog" aria-modal="true" aria-label="cart">
    <div class="modal">
      <div class="row">
        <h5>è³¼ç‰©è»Šï¼ˆç¤ºç¯„ï¼‰</h5>
        <button class="close" id="cartClose" aria-label="close">âœ•</button>
      </div>
      <div class="items" id="cartItems"></div>
      <div style="margin-top:12px; display:flex; gap:10px; justify-content:flex-end; align-items:center;">
        <button class="btn ghost" id="cartClear">æ¸…ç©º</button>
        <a class="btn" id="cartCheckout" href="#" target="_blank" rel="noopener">å‰å¾€çµå¸³</a>
      </div>
      <p style="margin:10px 2px 0; font-size:12px; color:rgba(111,127,115,.95); line-height:1.6;">
        â€» é€™æ˜¯ã€Œå…§å»ºç°¡æ˜“è³¼ç‰©è»Šã€ï¼šç›®å‰ç”¨æœ¬æ©Ÿå„²å­˜ï¼ˆlocalStorageï¼‰ã€‚
è¦çœŸæ­£æ”¶æ¬¾ï¼šæŠŠæ¯å€‹å•†å“çš„ Stripe Payment Link å¡«é€² data/products.json çš„ payment_linkã€‚
      </p>
    </div>
  </div>

  <script>
    async function loadJSON(path){
      const res = await fetch(path, { cache: "no-store" });
      if(!res.ok) throw new Error("Failed to load " + path);
      return await res.json();
    }
    function moneyTWD(n){ try{ return new Intl.NumberFormat("zh-TW").format(n);} catch(e){ return String(n);} }
    function setText(id, value){ const el=document.getElementById(id); if(el) el.textContent = value ?? ""; }
    function setMultiline(id, value){ const el=document.getElementById(id); if(el) el.textContent = value ?? ""; }
    function escapeHTML(s){ return String(s ?? "").replace(/[&<>"']/g, c => ({ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;" }[c])); }
    function escapeAttr(s){ return escapeHTML(s).replace(/"/g, "&quot;"); }

    function buildProductCard(p){
      const card = document.createElement("div");
      card.className = "product";
      card.innerHTML = `
        <div class="top">
          <h4>${escapeHTML(p.name)}</h4>
          <div class="price">NT$ ${moneyTWD(p.price_twd || 0)}</div>
        </div>
        <div class="meta">
          ${p.badge ? `<span class="chip">${escapeHTML(p.badge)}</span>` : ""}
          <span class="chip">TWD</span>
        </div>
        <p class="desc">${escapeHTML(p.desc || "")}</p>
        <div class="actions">
          <button class="btn" data-add="${escapeAttr(p.id)}">åŠ å…¥è³¼ç‰©è»Š</button>
          ${p.payment_link ? `<a class="btn ghost" href="${escapeAttr(p.payment_link)}" target="_blank" rel="noopener">ç«‹å³è³¼è²·</a>`
                           : `<button class="btn ghost" data-buy="${escapeAttr(p.id)}">ç«‹å³è³¼è²·</button>`}
        </div>
      `;
      return card;
    }

    const CART_KEY="tenyears_cart_v1";
    function readCart(){ try{ return JSON.parse(localStorage.getItem(CART_KEY) || "[]"); } catch(e){ return []; } }
    function writeCart(items){ localStorage.setItem(CART_KEY, JSON.stringify(items)); renderCart(); }
    function addToCart(id){ const items=readCart(); items.push({id, t:Date.now()}); writeCart(items); openCart(); }
    function clearCart(){ writeCart([]); }

    let PRODUCTS = [];
    function renderCart(){
      const items = readCart();
      const wrap = document.getElementById("cartItems");
      wrap.innerHTML = "";

      if(items.length === 0){
        wrap.innerHTML = `<div style="padding:10px 2px; color:rgba(111,127,115,.95); font-size:13px;">ç›®å‰æ²’æœ‰å•†å“ã€‚</div>`;
        document.getElementById("cartCheckout").href = "#";
        return;
      }

      const map = new Map();
      for(const it of items) map.set(it.id, (map.get(it.id) || 0) + 1);

      let total = 0;
      for(const [id, qty] of map.entries()){
        const p = PRODUCTS.find(x => x.id === id);
        const price = (p?.price_twd || 0) * qty;
        total += price;

        const row = document.createElement("div");
        row.className = "item";
        row.innerHTML = `
          <div>
            <div class="name">${escapeHTML(p?.name || id)}</div>
            <div class="sub">æ•¸é‡ï¼š${qty}</div>
          </div>
          <div class="right">NT$ ${moneyTWD(price)}</div>
        `;
        wrap.appendChild(row);
      }

      const totalRow = document.createElement("div");
      totalRow.className = "item";
      totalRow.innerHTML = `
        <div class="name">åˆè¨ˆ</div>
        <div class="right" style="font-weight:600;">NT$ ${moneyTWD(total)}</div>
      `;
      wrap.appendChild(totalRow);

      const uniq = [...map.keys()];
      const checkout = document.getElementById("cartCheckout");
      if(uniq.length === 1){
        const p = PRODUCTS.find(x => x.id === uniq[0]);
        if(p?.payment_link){
          checkout.href = p.payment_link;
          checkout.textContent = "å‰å¾€çµå¸³";
          return;
        }
      }
      checkout.href = "#";
      checkout.textContent = "ï¼ˆå…ˆå¡«å…¥ Stripe ä»˜æ¬¾é€£çµï¼‰";
    }

    function openCart(){
      document.getElementById("cartBackdrop").style.display = "flex";
      renderCart();
    }
    function closeCart(){
      document.getElementById("cartBackdrop").style.display = "none";
    }

    function updateActiveNav(){
      const hash = (location.hash || "#about").toLowerCase();
      document.querySelectorAll(".pill").forEach(a => {
        const isActive = (a.getAttribute("href") || "").toLowerCase() === hash;
        a.classList.toggle("active", isActive);
      });
    }

    async function init(){
      try{
        const c = await loadJSON("./data/content.json");
        setText("brandNameZh", c.brand_name_zh);
        setText("brandNameEn", c.brand_name_en);
        setText("brandHandle", c.handle);
        setText("heroTitle", c.hero_title);
        setMultiline("heroSubtitle", c.hero_subtitle);
        setText("welcomeTitle", c.welcome_title);
        setText("welcomeTagline", c.welcome_tagline);
        setMultiline("welcomeBody", c.welcome_body);
        setText("announcementLabel", c.announcement_label);
        setMultiline("announcementText", c.announcement_text);
        setText("freeShippingText", c.free_shipping_text);
        setText("footerText", c.footer_text);
      }catch(e){ console.warn(e); }

      try{
        PRODUCTS = await loadJSON("./data/products.json");
        const grid = document.getElementById("productsGrid");
        grid.innerHTML = "";
        PRODUCTS.forEach(p => grid.appendChild(buildProductCard(p)));
      }catch(e){ console.warn(e); }

      document.getElementById("btnCart").addEventListener("click", openCart);
      document.getElementById("cartClose").addEventListener("click", closeCart);
      document.getElementById("cartBackdrop").addEventListener("click", (ev) => {
        if(ev.target && ev.target.id === "cartBackdrop") closeCart();
      });
      document.getElementById("cartClear").addEventListener("click", clearCart);

      document.getElementById("btnSearch").addEventListener("click", () => {
        alert("æœå°‹ï¼ˆç¤ºç¯„ï¼‰ï¼šä¹‹å¾Œå¯åšæˆçœŸæ­£æœå°‹ã€‚");
      });
      document.getElementById("btnAccount").addEventListener("click", () => {
        alert("æœƒå“¡ï¼ˆç¤ºç¯„ï¼‰ï¼šä¹‹å¾Œå¯æ¥ç™»å…¥/è¨‚å–®æŸ¥è©¢ã€‚");
      });

      document.addEventListener("click", (ev) => {
        const add = ev.target?.getAttribute?.("data-add");
        const buy = ev.target?.getAttribute?.("data-buy");
        if(add){
          addToCart(add);
        }else if(buy){
          alert("æ­¤å•†å“å°šæœªå¡«å…¥ Stripe ä»˜æ¬¾é€£çµã€‚\n\nè«‹åˆ° data/products.json å°æ‡‰å•†å“å¡«å…¥ payment_linkã€‚");
        }
      });

      updateActiveNav();
      window.addEventListener("hashchange", updateActiveNav);
      renderCart();
    }

    init();
  </script>
</body>
</html>
